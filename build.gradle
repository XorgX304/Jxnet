
allprojects {
	
	apply plugin: 'java'

	group = 'com.ardikars.jxnet'
	version = '1.1.1-SHAPSHOT'

	sourceCompatibility = 1.8
	targetCompatibility = 1.8

	[compileJava, compileTestJava]*.options*.encoding = 'UTF-8'

	repositories {
		mavenCentral()
	}

}

apply from: 'config.gradle'

subprojects.each {
	subproject -> evaluationDependsOn(subproject.path)
}

jar.dependsOn subprojects.tasks["classes"]

jar {
	subprojects.each { subproject ->
		from subproject.sourceSets.main.output.classesDir
		from subproject.sourceSets.main.output.resourcesDir
	}
}

task ndkBuild(type: Exec) {
	commandLine "${NDK_HOME}/ndk-build", 
			'NDK_LIBS_OUT=./jxnet-core/src/main/resources/lib', "NDK_OUT=${NDK_OUT}"
}

task ndkClean(type: Exec) {
	commandLine "${NDK_HOME}/ndk-build", 'clean', 
			'NDK_LIBS_OUT=./jxnet-core/src/main/resources/lib', "NDK_OUT=${NDK_OUT}"
}

/*
tasks.withType(JavaCompile) {
	compileTask -> compileTask.dependsOn ndkBuild
}

clean.dependsOn 'ndkClean'
*/

